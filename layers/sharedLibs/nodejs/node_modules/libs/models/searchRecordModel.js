import { PutCommand, ScanCommand } from '@aws-sdk/lib-dynamodb';
import docClient from 'libs/dynamo/dynamoClient.js';

const TABLE_NAME = process.env.TABLE_NAME || 'UserSearchHistory';

export const saveSearchRecord = async ({ email, symbol, timestamp }) => {
  const item = {
    PK: `USER#${email}`,
    SK: `SEARCH#${timestamp}`,
    email,
    symbol,
    timestamp,
    recordType: 'SEARCH',
  };

  const command = new PutCommand({
    TableName: TABLE_NAME,
    Item: item,
  });

  return docClient.send(command);
};

export const getAllSearchRecord = async () => {
  const command = new ScanCommand({
    TableName: TABLE_NAME,
  });

  const result = await docClient.send(command);
  return result.Items;
};
